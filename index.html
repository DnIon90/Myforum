<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini Farm & Tank Miner</title>
<style>
body {
    margin:0;
    padding:0;
    font-family: Arial, sans-serif;
    background: linear-gradient(120deg, #111, #333);
    color: #fff;
    text-align: center;
}
h1 { margin: 20px 0; }
#coins { font-size: 2em; margin: 20px 0; }
canvas { display: block; margin: 0 auto; background: #222; border-radius: 10px; }

button, input {
    font-size: 1em;
    padding: 10px;
    margin: 5px;
    border-radius: 5px;
}
button { background: gold; color:#000; border:none; cursor:pointer; transition:0.3s; }
button:hover { transform: scale(1.1); }
input { width: 80%; }
</style>
</head>
<body>

<h1>Mini Farm & Tank Miner</h1>
<div id="coins">0.000000 BTC</div>
<canvas id="canvas" width="350" height="400"></canvas>

<h2>Upgrade</h2>
<button onclick="buyTank()">Cumpără Tanc (+0.0005 BTC/sec)</button>
<button onclick="buyFarm()">Cumpără Fermă (+0.0002 BTC/sec)</button>

<h2>Retragere pe PayPal</h2>
<input type="email" id="email" placeholder="Email PayPal" />
<input type="number" id="amount" placeholder="Amount USD" />
<button onclick="withdraw()">Retragere</button>
<pre id="result"></pre>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let coins = 0;
let tanks = 0;
let farms = 0;

const fallingCoins = [];

// Spawnează monede aleator
function spawnCoin() {
    fallingCoins.push({
        x: Math.random() * canvas.width,
        y: 0,
        radius: 10 + Math.random() * 5,
        speed: 1 + Math.random()*2
    });
}

// Update canvas
function update() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Desenează monede căzătoare
    for(let i=fallingCoins.length-1; i>=0; i--){
        const c = fallingCoins[i];
        c.y += c.speed;
        ctx.beginPath();
        ctx.arc(c.x, c.y, c.radius, 0, Math.PI*2);
        ctx.fillStyle = 'gold';
        ctx.fill();
        ctx.strokeStyle = '#fff';
        ctx.stroke();

        if(c.y > canvas.height){
            coins += 0.0001;
            fallingCoins.splice(i,1);
            updateDisplay();
        }
    }

    // Desenează tancuri și ferme
    for(let i=0;i<tanks;i++){
        ctx.fillStyle='red';
        ctx.fillRect(10+i*30,canvas.height-30,20,20);
    }
    for(let i=0;i<farms;i++){
        ctx.fillStyle='green';
        ctx.fillRect(10+i*30,canvas.height-60,20,20);
    }

    requestAnimationFrame(update);
}

// Click pentru colectare manuală
canvas.addEventListener('click', function(e){
    const rect = canvas.getBoundingClientRect();
    const mouseX = e.clientX - rect.left;
    const mouseY = e.clientY - rect.top;

    for(let i=fallingCoins.length-1;i>=0;i--){
        const c = fallingCoins[i];
        const dx = mouseX - c.x;
        const dy = mouseY - c.y;
        if(Math.sqrt(dx*dx+dy*dy) < c.radius){
            coins += 0.001;
            fallingCoins.splice(i,1);
            updateDisplay();
        }
    }
});

function updateDisplay() {
    document.getElementById('coins').innerText = coins.toFixed(6) + " BTC";
}

// Spawn monede la interval
setInterval(spawnCoin, 800);

// Mining automat + tancuri/ferme
setInterval(()=>{
    coins += 0.00001 + tanks*0.0005 + farms*0.0002;
    updateDisplay();
}, 1000);

update();

// Upgrade
function buyTank(){
    if(coins >= 0.01){ // preț tanc
        coins -= 0.01;
        tanks++;
        updateDisplay();
    } else {
        alert("Nu ai suficiente monede pentru tanc!");
    }
}

function buyFarm(){
    if(coins >= 0.005){ // preț fermă
        coins -= 0.005;
        farms++;
        updateDisplay();
    } else {
        alert("Nu ai suficiente monede pentru fermă!");
    }
}

// Withdraw via PayPal backend
async function withdraw() {
    const email = document.getElementById('email').value;
    const amount = parseFloat(document.getElementById('amount').value);

    if(amount > coins*1000){
        alert("Nu ai suficiente monede!");
        return;
    }

    try{
        const res = await fetch('https://YOUR_SERVER_DOMAIN/payout', {
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body: JSON.stringify({email, amount})
        });
        const data = await res.json();
        document.getElementById('result').innerText = JSON.stringify(data,null,2);

        if(data.batch_header && data.batch_header.batch_status === "SUCCESS"){
            coins -= amount/1000;
            updateDisplay();
        }

    } catch(e){
        console.error(e);
        alert("Eroare la retragere.");
    }
}
</script>

</body>
</html>