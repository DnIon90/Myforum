<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Galerie Poze & Video cu Login È™i Statistici</title>
<style>
body{font-family:Arial,sans-serif;background:#f2f6fb;color:#0b2236;margin:0;padding:18px}
.wrap{max-width:900px;margin:0 auto}
h1{text-align:center}
input,button{padding:10px;margin:4px;border-radius:6px;border:1px solid #ccc}
button{background:#0077ff;color:#fff;border:none;cursor:pointer}
button:hover{background:#0059c9}
.hidden{display:none}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;margin-top:12px}
img,video{max-width:100%;border-radius:6px}
.card{background:#fff;padding:6px;border-radius:6px;text-align:center;box-shadow:0 2px 6px rgba(0,0,0,0.1)}
.card button{margin:4px;font-size:12px;padding:6px 8px}
.stats{margin-top:10px;font-size:14px;color:#333;text-align:center}
</style>
</head>
<body>
<div class="wrap">
<h1>ðŸ“¸ Galerie Poze & Video</h1>

<div id="authDiv">
<h2>Login / Register</h2>
<input id="username" placeholder="Username"><br>
<input id="password" type="password" placeholder="ParolÄƒ"><br>
<button id="btnLogin">Login</button>
<button id="btnRegister">Register</button>
<div id="authMsg" style="color:red;margin-top:6px"></div>
</div>

<div id="appDiv" class="hidden">
<button id="btnLogout">Logout</button>
<h2>Upload Poze & Video</h2>
<input type="file" id="fileInput" multiple accept="image/*,video/*"><br>
<button id="btnUpload">ÃŽncarcÄƒ</button>
<div id="uploadMsg" style="margin-top:6px;color:green"></div>

<div class="stats" id="statsDiv"></div>

<h3>Galeria ta</h3>
<div id="gallery" class="grid"></div>
</div>
</div>

<script>
// ------------------------
// Stocare localÄƒ utilizatori
// ------------------------
let users = JSON.parse(localStorage.getItem('users') || '{}');
let currentUser = null;

function saveUsers(){ localStorage.setItem('users', JSON.stringify(users)); }
function showAuth(msg){ 
  document.getElementById('authDiv').classList.remove('hidden'); 
  document.getElementById('appDiv').classList.add('hidden'); 
  document.getElementById('authMsg').innerText=msg||'';
}
function showApp(){ 
  document.getElementById('authDiv').classList.add('hidden'); 
  document.getElementById('appDiv').classList.remove('hidden'); 
  loadGallery(); 
  updateStats();
}

// ------------------------
// Login & Register
// ------------------------
document.getElementById('btnRegister').addEventListener('click', ()=>{
  const u = document.getElementById('username').value.trim();
  const p = document.getElementById('password').value.trim();
  if(!u||!p){ showAuth('CompleteazÄƒ username È™i parolÄƒ'); return;}
  if(users[u]){ showAuth('Username deja existÄƒ'); return;}
  users[u] = { password: p, files: [] };
  saveUsers();
  showAuth('Cont creat, te poÈ›i loga');
});

document.getElementById('btnLogin').addEventListener('click', ()=>{
  const u = document.getElementById('username').value.trim();
  const p = document.getElementById('password').value.trim();
  if(!u||!p){ showAuth('CompleteazÄƒ username È™i parolÄƒ'); return;}
  if(!users[u] || users[u].password !== p){ showAuth('Username/parolÄƒ incorecte'); return;}
  currentUser = u;
  showApp();
});

document.getElementById('btnLogout').addEventListener('click', ()=>{
  currentUser = null; showAuth();
});

// ------------------------
// Upload
// ------------------------
document.getElementById('btnUpload').addEventListener('click', ()=>{
  if(!currentUser) return;
  const files = document.getElementById('fileInput').files;
  if(files.length===0){ alert('SelecteazÄƒ fiÈ™iere'); return;}
  for(const f of files){
    const reader = new FileReader();
    reader.onload = e=>{
      users[currentUser].files.push({name:f.name,type:f.type,data:e.target.result});
      saveUsers();
      loadGallery();
      updateStats();
    };
    reader.readAsDataURL(f);
  }
});

// ------------------------
// Galerie
// ------------------------
function loadGallery(){
  if(!currentUser) return;
  const gal = document.getElementById('gallery');
  gal.innerHTML = '';
  users[currentUser].files.forEach((f,i)=>{
    const card = document.createElement('div'); 
    card.className='card';
    
    if(f.type.startsWith('image/')){
      const img = document.createElement('img'); img.src=f.data; card.appendChild(img);
    } else if(f.type.startsWith('video/')){
      const v = document.createElement('video'); v.src=f.data; v.controls=true; card.appendChild(v);
    }
    
    // Butoane descÄƒrcare & È™tergere
    const dl = document.createElement('button'); dl.textContent="DescÄƒrcare";
    dl.onclick=()=>downloadFile(f);
    const del = document.createElement('button'); del.textContent="È˜tergere";
    del.onclick=()=>deleteFile(i);
    card.appendChild(document.createElement('br'));
    card.appendChild(dl); card.appendChild(del);

    gal.appendChild(card);
  });
}

// ------------------------
// FuncÈ›ii extra
// ------------------------
function updateStats(){
  if(!currentUser) return;
  const files = users[currentUser].files;
  const images = files.filter(f=>f.type.startsWith('image/')).length;
  const videos = files.filter(f=>f.type.startsWith('video/')).length;
  document.getElementById('statsDiv').innerText = 
    `Poze: ${images} | Videoclipuri: ${videos} | Total fiÈ™iere: ${files.length}`;
}

function deleteFile(index){
  if(!currentUser) return;
  users[currentUser].files.splice(index,1);
  saveUsers();
  loadGallery();
  updateStats();
}

function downloadFile(f){
  const a = document.createElement('a');
  a.href = f.data;
  a.download = f.name;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

// ------------------------
showAuth();
</script>
</body>
</html>