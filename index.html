<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Galerie cu Login, Statistici È™i Foldere</title>
<style>
body{font-family:Arial,sans-serif;background:#f2f6fb;color:#0b2236;margin:0;padding:18px}
.wrap{max-width:900px;margin:0 auto}
h1{text-align:center}
input,button,select{padding:8px;margin:4px;border-radius:6px;border:1px solid #ccc}
button{background:#0077ff;color:#fff;border:none;cursor:pointer}
button:hover{background:#0059c9}
.hidden{display:none}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:10px;margin-top:12px}
img,video{max-width:100%;max-height:100px;border-radius:6px;object-fit:cover}
.card{background:#fff;padding:6px;border-radius:6px;text-align:center;box-shadow:0 2px 6px rgba(0,0,0,0.1)}
.card button{margin:2px;font-size:11px;padding:4px 6px}
.stats{margin-top:10px;font-size:14px;color:#333;text-align:center}
.folderBar{margin:10px 0;padding:6px;background:#e9f0fb;border-radius:6px}
</style>
</head>
<body>
<div class="wrap">
<h1>ðŸ“‚ Galerie Poze & Video</h1>

<div id="authDiv">
<h2>Login / Register</h2>
<input id="username" placeholder="Username"><br>
<input id="password" type="password" placeholder="ParolÄƒ"><br>
<button id="btnLogin">Login</button>
<button id="btnRegister">Register</button>
<div id="authMsg" style="color:red;margin-top:6px"></div>
</div>

<div id="appDiv" class="hidden">
<button id="btnLogout">Logout</button>

<div class="folderBar">
ðŸ“‚ Folder curent: <b id="currentFolderName">Principal</b><br>
<select id="folderSelect"></select>
<button id="btnNewFolder">+ Nou Folder</button>
</div>

<h2>Upload Poze & Video</h2>
<input type="file" id="fileInput" multiple accept="image/*,video/*"><br>
<button id="btnUpload">ÃŽncarcÄƒ</button>
<div id="uploadMsg" style="margin-top:6px;color:green"></div>

<div class="stats" id="statsDiv"></div>

<h3>Galeria ta</h3>
<div id="gallery" class="grid"></div>
</div>
</div>

<script>
// ------------------------
// Stocare localÄƒ utilizatori
// ------------------------
let users = JSON.parse(localStorage.getItem('users') || '{}');
let currentUser = localStorage.getItem('currentUser') || null;
let currentFolder = "Principal";

function saveUsers(){ localStorage.setItem('users', JSON.stringify(users)); }
function showAuth(msg){ 
  document.getElementById('authDiv').classList.remove('hidden'); 
  document.getElementById('appDiv').classList.add('hidden'); 
  document.getElementById('authMsg').innerText=msg||'';
}
function showApp(){ 
  document.getElementById('authDiv').classList.add('hidden'); 
  document.getElementById('appDiv').classList.remove('hidden'); 
  if(!users[currentUser].folders) users[currentUser].folders = { "Principal": [] };
  loadFolders();
  loadGallery();
  updateStats();
}

// ------------------------
// Login & Register
// ------------------------
document.getElementById('btnRegister').addEventListener('click', ()=>{
  const u = document.getElementById('username').value.trim();
  const p = document.getElementById('password').value.trim();
  if(!u||!p){ showAuth('CompleteazÄƒ username È™i parolÄƒ'); return;}
  if(users[u]){ showAuth('Username deja existÄƒ'); return;}
  users[u] = { password: p, folders: { "Principal": [] } };
  saveUsers();
  showAuth('Cont creat, te poÈ›i loga');
});

document.getElementById('btnLogin').addEventListener('click', ()=>{
  const u = document.getElementById('username').value.trim();
  const p = document.getElementById('password').value.trim();
  if(!u||!p){ showAuth('CompleteazÄƒ username È™i parolÄƒ'); return;}
  if(!users[u] || users[u].password !== p){ showAuth('Username/parolÄƒ incorecte'); return;}
  currentUser = u;
  localStorage.setItem("currentUser", currentUser);
  showApp();
});

document.getElementById('btnLogout').addEventListener('click', ()=>{
  currentUser = null;
  localStorage.removeItem("currentUser");
  showAuth();
});

// ------------------------
// Upload
// ------------------------
document.getElementById('btnUpload').addEventListener('click', ()=>{
  if(!currentUser) return;
  const files = document.getElementById('fileInput').files;
  if(files.length===0){ alert('SelecteazÄƒ fiÈ™iere'); return;}
  for(const f of files){
    const url = URL.createObjectURL(f); // link temporar
    users[currentUser].folders[currentFolder].push({name:f.name,type:f.type,data:url});
  }
  saveUsers();
  loadGallery();
  updateStats();
});

// ------------------------
// Galerie
// ------------------------
function loadGallery(){
  if(!currentUser) return;
  const gal = document.getElementById('gallery');
  gal.innerHTML = '';
  const files = users[currentUser].folders[currentFolder] || [];
  files.forEach((f,i)=>{
    const card = document.createElement('div'); card.className='card';
    if(f.type.startsWith('image/')){
      const img = document.createElement('img'); img.src=f.data; card.appendChild(img);
    } else if(f.type.startsWith('video/')){
      const v = document.createElement('video'); v.src=f.data; v.controls=true; card.appendChild(v);
    }
    const dl = document.createElement('button'); dl.textContent="DescÄƒrcare";
    dl.onclick=()=>downloadFile(f);
    const del = document.createElement('button'); del.textContent="È˜tergere";
    del.onclick=()=>deleteFile(i);
    card.appendChild(document.createElement('br'));
    card.appendChild(dl); card.appendChild(del);
    gal.appendChild(card);
  });
}

// ------------------------
// Foldere
// ------------------------
function loadFolders(){
  const sel = document.getElementById("folderSelect");
  sel.innerHTML="";
  const folders = Object.keys(users[currentUser].folders);
  folders.forEach(f=>{
    const opt=document.createElement("option");
    opt.value=f; opt.text=f;
    if(f===currentFolder) opt.selected=true;
    sel.appendChild(opt);
  });
  document.getElementById("currentFolderName").innerText=currentFolder;
}
document.getElementById("folderSelect").addEventListener("change",e=>{
  currentFolder=e.target.value;
  loadGallery();
  updateStats();
  document.getElementById("currentFolderName").innerText=currentFolder;
});
document.getElementById("btnNewFolder").addEventListener("click",()=>{
  const name=prompt("Nume folder nou:");
  if(!name) return;
  if(users[currentUser].folders[name]){alert("ExistÄƒ deja!");return;}
  users[currentUser].folders[name]=[];
  saveUsers();
  currentFolder=name;
  loadFolders();
  loadGallery();
  updateStats();
});

// ------------------------
// Extra
// ------------------------
function updateStats(){
  if(!currentUser) return;
  const files = users[currentUser].folders[currentFolder] || [];
  const images = files.filter(f=>f.type.startsWith('image/')).length;
  const videos = files.filter(f=>f.type.startsWith('video/')).length;
  document.getElementById('statsDiv').innerText = 
    `Folder: ${currentFolder} | Poze: ${images} | Video: ${videos} | Total: ${files.length}`;
}

function deleteFile(index){
  if(!currentUser) return;
  users[currentUser].folders[currentFolder].splice(index,1);
  saveUsers();
  loadGallery();
  updateStats();
}

function downloadFile(f){
  const a = document.createElement('a');
  a.href = f.data;
  a.download = f.name;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

// ------------------------
// La Ã®ncÄƒrcare
// ------------------------
if (currentUser && users[currentUser]) {
  showApp();
} else {
  showAuth();
}
</script>
</body>
</html>